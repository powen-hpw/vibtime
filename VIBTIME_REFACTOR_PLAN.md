# ğŸ¯ Vibtime ä»£ç¢¼å„ªåŒ–ä»»å‹™æ¸…å–®

## ğŸ“‹ ä»»å‹™åˆ†é¡èˆ‡å„ªå…ˆç´š

### ğŸŸ¢ Level 1: åŸºç¤é…ç½®ä¿®å¾© (ç¨ç«‹ä»»å‹™)
**ç‰¹é»ï¼š** äº’ä¸å½±éŸ¿ã€å¿«é€Ÿå®Œæˆã€ç«‹å³è¦‹æ•ˆ

#### Task 1.1: ä¿®å¾© Gradle é…ç½®
- **å½±éŸ¿ç¯„åœï¼š** è·¨å¹³å°å…¼å®¹æ€§
- **æ™‚é–“ä¼°è¨ˆï¼š** 5åˆ†é˜
- **ä¾è³´é—œä¿‚ï¼š** ç„¡
- **é¢¨éšªç­‰ç´šï¼š** ä½
- **æ–‡ä»¶ï¼š** `gradle.properties`

#### Task 1.2: çµ±ä¸€ ViewBinding - MainActivity
- **å½±éŸ¿ç¯„åœï¼š** ä¸»Activity
- **æ™‚é–“ä¼°è¨ˆï¼š** 10åˆ†é˜
- **ä¾è³´é—œä¿‚ï¼š** ç„¡
- **é¢¨éšªç­‰ç´šï¼š** ä½
- **æ–‡ä»¶ï¼š** `MainActivity.kt`

### ğŸŸ¡ Level 2: UIå±¤å„ªåŒ– (å¹³è¡ŒåŸ·è¡Œ)
**ç‰¹é»ï¼š** Fragmenté–“äº’ä¸å½±éŸ¿ã€å¯ä¸¦è¡Œé–‹ç™¼

#### Task 2.1: ViewBinding - HomeFragment
- **å½±éŸ¿ç¯„åœï¼š** é¦–é åŠŸèƒ½
- **æ™‚é–“ä¼°è¨ˆï¼š** 15åˆ†é˜
- **ä¾è³´é—œä¿‚ï¼š** Task 1.2å®Œæˆå¾Œ
- **é¢¨éšªç­‰ç´šï¼š** ä½
- **æ–‡ä»¶ï¼š** `ui/home/HomeFragment.kt`

#### Task 2.2: ViewBinding - SettingsFragment  
- **å½±éŸ¿ç¯„åœï¼š** è¨­å®šé é¢
- **æ™‚é–“ä¼°è¨ˆï¼š** 20åˆ†é˜
- **ä¾è³´é—œä¿‚ï¼š** Task 1.2å®Œæˆå¾Œ
- **é¢¨éšªç­‰ç´šï¼š** ä¸­
- **æ–‡ä»¶ï¼š** `ui/settings/SettingsFragment.kt`

#### Task 2.3: ViewBinding - VibrationFragment
- **å½±éŸ¿ç¯„åœï¼š** éœ‡å‹•è¨­å®š
- **æ™‚é–“ä¼°è¨ˆï¼š** 15åˆ†é˜
- **ä¾è³´é—œä¿‚ï¼š** Task 1.2å®Œæˆå¾Œ
- **é¢¨éšªç­‰ç´šï¼š** ä½
- **æ–‡ä»¶ï¼š** `ui/vibration/VibrationFragment.kt`

#### Task 2.4: ViewBinding - HistoryFragment
- **å½±éŸ¿ç¯„åœï¼š** æ­·å²è¨˜éŒ„
- **æ™‚é–“ä¼°è¨ˆï¼š** 15åˆ†é˜
- **ä¾è³´é—œä¿‚ï¼š** Task 1.2å®Œæˆå¾Œ
- **é¢¨éšªç­‰ç´šï¼š** ä½
- **æ–‡ä»¶ï¼š** `ui/history/HistoryFragment.kt`

#### Task 2.5: ViewBinding - å…¶ä»–Fragment
- **å½±éŸ¿ç¯„åœï¼š** RunningFragment, WelcomeFragment
- **æ™‚é–“ä¼°è¨ˆï¼š** 10åˆ†é˜
- **ä¾è³´é—œä¿‚ï¼š** Task 1.2å®Œæˆå¾Œ
- **é¢¨éšªç­‰ç´šï¼š** ä½
- **æ–‡ä»¶ï¼š** `ui/running/RunningFragment.kt`, `ui/welcome/WelcomeFragment.kt`

### ğŸ”´ Level 3: æ ¸å¿ƒåŠŸèƒ½é‡æ§‹ (è¤‡é›œä»»å‹™)
**ç‰¹é»ï¼š** æ¶‰åŠAndroidåˆè¦ã€éœ€è¦ä»”ç´°æ¸¬è©¦

#### Task 3.1: è¨­è¨ˆ WatchModeManager æ¶æ§‹
- **å½±éŸ¿ç¯„åœï¼š** æ ¸å¿ƒæ„Ÿæ¸¬å™¨é‚è¼¯
- **æ™‚é–“ä¼°è¨ˆï¼š** 30åˆ†é˜
- **ä¾è³´é—œä¿‚ï¼š** Task 2.1å®Œæˆå¾Œ
- **é¢¨éšªç­‰ç´šï¼š** é«˜
- **æ–‡ä»¶ï¼š** `utils/WatchModeManager.kt` (æ–°å»º)

#### Task 3.2: å¯¦ç¾é™æ™‚ç›£è½æ©Ÿåˆ¶
- **å½±éŸ¿ç¯„åœï¼š** èƒŒæ™¯æ„Ÿæ¸¬å™¨ä½¿ç”¨
- **æ™‚é–“ä¼°è¨ˆï¼š** 45åˆ†é˜
- **ä¾è³´é—œä¿‚ï¼š** Task 3.1å®Œæˆå¾Œ
- **é¢¨éšªç­‰ç´šï¼š** é«˜
- **æ–‡ä»¶ï¼š** `service/TapDetectionService.kt`

#### Task 3.3: å¯¦ç¾å†·å»æœŸæ©Ÿåˆ¶
- **å½±éŸ¿ç¯„åœï¼š** å ±æ™‚å¾Œè¡Œç‚º
- **æ™‚é–“ä¼°è¨ˆï¼š** 30åˆ†é˜
- **ä¾è³´é—œä¿‚ï¼š** Task 3.2å®Œæˆå¾Œ
- **é¢¨éšªç­‰ç´šï¼š** ä¸­
- **æ–‡ä»¶ï¼š** `utils/WatchModeManager.kt`, `utils/SafetyManager.kt`

#### Task 3.4: æ›´æ–° SafetyManager åˆè¦æª¢æŸ¥
- **å½±éŸ¿ç¯„åœï¼š** å®‰å…¨æ©Ÿåˆ¶
- **æ™‚é–“ä¼°è¨ˆï¼š** 20åˆ†é˜
- **ä¾è³´é—œä¿‚ï¼š** Task 3.3å®Œæˆå¾Œ
- **é¢¨éšªç­‰ç´šï¼š** ä¸­
- **æ–‡ä»¶ï¼š** `utils/SafetyManager.kt`

---

## ğŸš€ æœ€ä½³åŸ·è¡Œæµç¨‹

### Phase 1: å¿«é€Ÿä¿®å¾© (ä¸¦è¡ŒåŸ·è¡Œ)
```
Task 1.1 (Gradle) â”€â”€â”
                    â”œâ”€â”€ å¯åŒæ™‚é€²è¡Œ
Task 1.2 (MainActivity) â”€â”€â”˜
```

### Phase 2: UIå±¤å„ªåŒ– (ä¸¦è¡ŒåŸ·è¡Œ)
```
Task 1.2 â”€â”€â”¬â”€â”€ Task 2.1 (HomeFragment)
           â”œâ”€â”€ Task 2.2 (SettingsFragment)  
           â”œâ”€â”€ Task 2.3 (VibrationFragment)
           â”œâ”€â”€ Task 2.4 (HistoryFragment)
           â””â”€â”€ Task 2.5 (å…¶ä»–Fragment)
```

### Phase 3: æ ¸å¿ƒåŠŸèƒ½ (åºåˆ—åŸ·è¡Œ)
```
Task 2.1 â”€â”€ Task 3.1 â”€â”€ Task 3.2 â”€â”€ Task 3.3 â”€â”€ Task 3.4
```

---

## ğŸ’¡ Coding æœ€ä½³è§£å»ºè­°

### ğŸ”§ Task 1.1: Gradle é…ç½®ä¿®å¾©

**å•é¡Œä»£ç¢¼ï¼š**
```properties
# gradle.properties
org.gradle.java.home=/Applications/Android Studio.app/Contents/jbr/Contents/Home
```

**æœ€ä½³è§£ï¼š**
```properties
# gradle.properties
# ç§»é™¤çµ•å°è·¯å¾‘ï¼Œè®“Gradleè‡ªå‹•æª¢æ¸¬
# org.gradle.java.home=/Applications/Android Studio.app/Contents/jbr/Contents/Home

# æˆ–è€…ä½¿ç”¨ç’°å¢ƒè®Šæ•¸ (CI/CDå‹å¥½)
# org.gradle.java.home=${JAVA_HOME}
```

**è¦å‰‡ï¼š**
- âŒ ä¸ä½¿ç”¨çµ•å°è·¯å¾‘
- âœ… ä¾è³´JAVA_HOMEç’°å¢ƒè®Šæ•¸
- âœ… local.propertiesä¸ç´å…¥ç‰ˆæœ¬æ§åˆ¶

---

### ğŸ¨ Task 2.x: ViewBinding æ¨™æº–å¯¦ç¾

**éŒ¯èª¤æ¨¡å¼ï¼š**
```kotlin
// âŒ éŒ¯èª¤ï¼šä¸æ˜ç¢ºçš„å‹åˆ¥
private var _binding: View? = null
private val binding get() = _binding!!
```

**æœ€ä½³å¯¦ç¾ï¼š**
```kotlin
// âœ… æ­£ç¢ºï¼šå¼·å‹åˆ¥ + æ¨™æº–æ¨¡å¼
private var _binding: FragmentHomeBinding? = null
private val binding get() = _binding!!

override fun onCreateView(
    inflater: LayoutInflater,
    container: ViewGroup?,
    savedInstanceState: Bundle?
): View {
    _binding = FragmentHomeBinding.inflate(inflater, container, false)
    return binding.root
}

override fun onDestroyView() {
    super.onDestroyView()
    _binding = null
}
```

**è¦å‰‡ï¼š**
- âœ… ä½¿ç”¨å…·é«”çš„Bindingé¡å‹ï¼ˆå¦‚`FragmentHomeBinding`ï¼‰
- âœ… åœ¨`onDestroyView()`ä¸­è¨­ç‚ºnullé˜²æ­¢è¨˜æ†¶é«”æ´©æ¼
- âœ… ä½¿ç”¨`binding.root`è¿”å›View
- âŒ ä¸è¦åœ¨Fragmentä¸­æ‰‹å‹•ä½¿ç”¨`findViewById`

---

### ğŸ¯ Task 3.x: Watch Mode åˆè¦å¯¦ç¾

**ç•¶å‰ä¸åˆè¦ä»£ç¢¼ï¼š**
```kotlin
// âŒ ä¸åˆè¦ï¼šæŒçºŒç›£è½
sensorManager.registerListener(
    this, 
    accelerometer, 
    SensorManager.SENSOR_DELAY_UI
)
```

**åˆè¦æœ€ä½³å¯¦ç¾ï¼š**
```kotlin
// âœ… åˆè¦ï¼šé™æ™‚ + Wake-up sensor
class WatchModeManager(private val context: Context) {
    
    companion object {
        private const val WATCH_MODE_DURATION_10MIN = 10 * 60 * 1000L
        private const val WATCH_MODE_DURATION_2HOUR = 2 * 60 * 60 * 1000L
        private const val COOLDOWN_PERIOD = 15 * 60 * 1000L
    }
    
    private var watchModeStartTime = 0L
    private var watchModeDuration = WATCH_MODE_DURATION_10MIN
    private var lastVibrationTime = 0L
    
    fun startWatchMode(duration: Long = WATCH_MODE_DURATION_10MIN): Boolean {
        // æª¢æŸ¥å†·å»æœŸ
        if (isInCooldownPeriod()) {
            return false
        }
        
        watchModeStartTime = System.currentTimeMillis()
        watchModeDuration = duration
        
        // ä½¿ç”¨wake-up sensor
        val accelerometer = sensorManager.getDefaultSensor(
            Sensor.TYPE_ACCELEROMETER, 
            true // wakeUp = true
        )
        
        if (accelerometer?.isWakeUpSensor == true) {
            sensorManager.registerListener(
                this,
                accelerometer,
                SensorManager.SENSOR_DELAY_NORMAL // ä½¿ç”¨NORMALè€ŒéUI
            )
            
            // è¨­å®šè‡ªå‹•åœæ­¢
            handler.postDelayed({
                stopWatchMode()
            }, duration)
            
            return true
        }
        
        return false
    }
    
    private fun isInCooldownPeriod(): Boolean {
        val timeSinceLastVibration = System.currentTimeMillis() - lastVibrationTime
        return timeSinceLastVibration < COOLDOWN_PERIOD
    }
    
    private fun onTimeVibrationTriggered() {
        lastVibrationTime = System.currentTimeMillis()
        // é€²å…¥å†·å»æœŸï¼Œè‡ªå‹•åœæ­¢Watch Mode
        stopWatchMode()
        
        // é€šçŸ¥ç”¨æˆ¶å†·å»æœŸé–‹å§‹
        showCooldownNotification()
    }
}
```

**è¦å‰‡ï¼š**
- âœ… é™æ™‚ç›£è½ï¼ˆ10åˆ†é˜/2å°æ™‚é¸é …ï¼‰
- âœ… ä½¿ç”¨wake-up sensor (`isWakeUpSensor = true`)
- âœ… ä½¿ç”¨`SENSOR_DELAY_NORMAL`è€Œé`SENSOR_DELAY_UI`
- âœ… å ±æ™‚å¾Œç«‹å³é€²å…¥15åˆ†é˜å†·å»æœŸ
- âœ… æä¾›æ˜ç¢ºçš„ç”¨æˆ¶é€šçŸ¥å’Œæ§åˆ¶
- âŒ ä¸æŒçºŒç›£è½æ„Ÿæ¸¬å™¨
- âŒ ä¸åœ¨å†·å»æœŸå…§éŸ¿æ‡‰æ„Ÿæ¸¬å™¨

---

## ğŸ“ è³ªé‡æª¢æŸ¥è¦å‰‡

### ğŸ” Code Review Checklist

**ViewBinding æª¢æŸ¥ï¼š**
- [ ] æ‰€æœ‰Fragmentä½¿ç”¨å¼·å‹åˆ¥Binding
- [ ] `onDestroyView()`æ­£ç¢ºæ¸…ç†binding
- [ ] æ²’æœ‰`findViewById`çš„ä½¿ç”¨
- [ ] æ­£ç¢ºä½¿ç”¨`binding.root`

**Watch Mode æª¢æŸ¥ï¼š**
- [ ] æ„Ÿæ¸¬å™¨ç›£è½æœ‰æ™‚é–“é™åˆ¶
- [ ] ä½¿ç”¨wake-up sensor
- [ ] å¯¦ç¾å†·å»æœŸæ©Ÿåˆ¶
- [ ] æä¾›ç”¨æˆ¶æ§åˆ¶ä»‹é¢
- [ ] ç¬¦åˆAndroid 12+èƒŒæ™¯é™åˆ¶

**Gradle æª¢æŸ¥ï¼š**
- [ ] æ²’æœ‰çµ•å°è·¯å¾‘
- [ ] CI/CDå…¼å®¹
- [ ] local.propertiesä¸åœ¨ç‰ˆæœ¬æ§åˆ¶ä¸­

### ğŸ§ª æ¸¬è©¦ç­–ç•¥

**Unit Tests:**
- `WatchModeManager` æ™‚é–“é‚è¼¯æ¸¬è©¦
- `SafetyManager` å†·å»æœŸæ¸¬è©¦

**Integration Tests:**
- ViewBindingæ­£ç¢ºç¶å®šæ¸¬è©¦
- æ„Ÿæ¸¬å™¨è¨»å†Š/å–æ¶ˆè¨»å†Šæ¸¬è©¦

**Manual Tests:**
- ä¸åŒAndroidç‰ˆæœ¬å…¼å®¹æ€§
- èƒŒæ™¯é‹è¡Œåˆè¦æ€§
- é›»æ± å„ªåŒ–å½±éŸ¿æ¸¬è©¦

---

## ğŸ¯ åŸ·è¡Œå»ºè­°

**ç«‹å³é–‹å§‹ï¼š**
1. Task 1.1 + 1.2 (15åˆ†é˜å…§å®Œæˆ)
2. Task 2.1-2.5 (å¯åˆ†é…çµ¦ä¸åŒé–‹ç™¼è€…ä¸¦è¡Œ)
3. Task 3.1-3.4 (éœ€è¦ä»”ç´°è¨­è¨ˆå’Œæ¸¬è©¦)

**é—œéµæˆåŠŸå› ç´ ï¼š**
- åš´æ ¼éµå¾ªViewBindingæ¨™æº–æ¨¡å¼
- Watch Modeå¿…é ˆé€šéAndroidåˆè¦æ¸¬è©¦
- æ¯å€‹taskå®Œæˆå¾Œç«‹å³æ¸¬è©¦

---

## ğŸ“ é€²åº¦è¿½è¹¤

### Phase 1 é€²åº¦
- [x] Task 1.1: ä¿®å¾© Gradle é…ç½®
- [x] Task 1.2: çµ±ä¸€ ViewBinding - MainActivity

### Phase 2 é€²åº¦
- [x] Task 2.1: ViewBinding - HomeFragment
- [x] Task 2.2: ViewBinding - SettingsFragment
- [x] Task 2.3: ViewBinding - VibrationFragment
- [x] Task 2.4: ViewBinding - HistoryFragment
- [x] Task 2.5: ViewBinding - å…¶ä»–Fragment

### Phase 3 é€²åº¦
- [x] Task 3.1: è¨­è¨ˆ WatchModeManager æ¶æ§‹
- [x] Task 3.2: å¯¦ç¾é™æ™‚ç›£è½æ©Ÿåˆ¶
- [x] Task 3.3: å¯¦ç¾å†·å»æœŸæ©Ÿåˆ¶
- [x] Task 3.4: æ›´æ–° SafetyManager åˆè¦æª¢æŸ¥

---

## ğŸ”„ ä¿®æ”¹è¨˜éŒ„

**2024-XX-XX:**
- å‰µå»ºä»»å‹™èªªæ˜æª”
- å®Œæˆ Phase 1: åŸºç¤é…ç½®ä¿®å¾©
- å®Œæˆ Phase 2: UIå±¤å„ªåŒ– (æ‰€æœ‰Fragment ViewBindingæ¨™æº–åŒ–)
- å®Œæˆ Phase 3: æ ¸å¿ƒåŠŸèƒ½é‡æ§‹ (WatchModeManageråˆè¦å¯¦ç¾)
- æ‰€æœ‰ä»»å‹™å®Œæˆï¼Œä»£ç¢¼è³ªé‡å¤§å¹…æå‡
